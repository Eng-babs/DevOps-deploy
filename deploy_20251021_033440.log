
==========================================
 🚀 Starting Automated Deployment Script
==========================================

Enter your Git repository URL: Enter your Personal Access Token (leave blank if public): Enter branch name (default: main): Enter remote server username: Enter remote server IP address: Enter SSH private key path (e.g., ~/.ssh/key.pem): Enter application internal port (e.g., 3000): 
✅ Parameters collected successfully.
-------------------------------------------
Repository: https://github.com/Eng-babs/DevOps-deploy.git
Branch: main
Server: ubuntu@3.88.156.135
App Port: 3000
-------------------------------------------

📦 Cloning or updating the repository...
Repository already exists locally. Pulling latest changes...
From https://github.com/Eng-babs/DevOps-deploy
 * branch            main       -> FETCH_HEAD
Your branch is up to date with 'origin/main'.
Already on 'main'
From https://github.com/Eng-babs/DevOps-deploy
 * branch            main       -> FETCH_HEAD
Already up to date.
✅ Repository ready in /c/Users/core i5/DevOps-deploy/DevOps-deploy
✅ Docker configuration found.

🔐 Testing SSH connection to remote server...
✅ SSH connection successful on DESKTOP-HPDACPJ
✅ Remote server reachable and SSH working.

⚙️ Setting up the remote environment...

======================================
 🧩 Preparing Remote Server Environment
======================================
🔄 Updating system packages...
Hit:1 http://us-east-1.ec2.archive.ubuntu.com/ubuntu noble InRelease
Hit:2 http://us-east-1.ec2.archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:3 http://us-east-1.ec2.archive.ubuntu.com/ubuntu noble-backports InRelease
Hit:4 http://security.ubuntu.com/ubuntu noble-security InRelease
Reading package lists...
📦 Installing Docker, Docker Compose, and Nginx (if missing)...
Reading package lists...
Building dependency tree...
Reading state information...
ca-certificates is already the newest version (20240203).
curl is already the newest version (8.5.0-2ubuntu10.6).
gnupg is already the newest version (2.4.4-2ubuntu17.3).
lsb-release is already the newest version (12.0-2).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
✅ Docker already installed.
✅ Docker Compose already installed.
✅ Nginx already installed.

✅ Versions installed:
Docker version 28.2.2, build 28.2.2-0ubuntu1~24.04.1
docker-compose version 1.29.2, build unknown
nginx version: nginx/1.24.0 (Ubuntu)
✅ Remote server setup complete!

🚀 Deploying Dockerized application on remote server...

🐳 Building and running Docker containers...
⚙️ No docker-compose.yml found, using Dockerfile...
Error response from daemon: No such container: app_deploy
Error response from daemon: No such container: app_deploy
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            Install the buildx component to build images with BuildKit:
            https://docs.docker.com/go/buildx/

Sending build context to Docker daemon  77.31kB
Step 1/6 : FROM node:18-alpine
18-alpine: Pulling from library/node
f18232174bc9: Pulling fs layer
dd71dde834b5: Pulling fs layer
1e5a4c89cee5: Pulling fs layer
25ff2da83641: Pulling fs layer
25ff2da83641: Waiting
1e5a4c89cee5: Verifying Checksum
1e5a4c89cee5: Download complete
f18232174bc9: Verifying Checksum
f18232174bc9: Download complete
25ff2da83641: Verifying Checksum
25ff2da83641: Download complete
dd71dde834b5: Verifying Checksum
dd71dde834b5: Download complete
f18232174bc9: Pull complete
dd71dde834b5: Pull complete
1e5a4c89cee5: Pull complete
25ff2da83641: Pull complete
Digest: sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
Status: Downloaded newer image for node:18-alpine
 ---> ee77c6cd7c18
Step 2/6 : WORKDIR /usr/src/app
 ---> Running in 34714686a8f2
 ---> Removed intermediate container 34714686a8f2
 ---> daea8457220e
Step 3/6 : COPY package*.json ./
COPY failed: no source files were specified
